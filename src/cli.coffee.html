<!DOCTYPE html>
<html>
<head>
  <title>cli.coffee</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../doc-style.css" />
  <script src="../doc-filelist.js"></script>
  <script>
    var relativeDir = "../";
    var thisFile = "src/cli.coffee";
    var defaultSidebar = true;
  </script>
  <script src="../doc-script.js"></script>

<meta name="viewport" content="width=device-width, initial-scale=1.0" /></head>
<body>
  <nav>
<div class="logo"><a href="http://alinex.github.io"
  onmouseover="logo.src='https://alinex.github.io/images/Alinex-200.png'"
  onmouseout="logo.src='https://alinex.github.io/images/Alinex-black-200.png'">
  <img name="logo" src="https://alinex.github.io/images/Alinex-black-200.png"
    width="150" title="Alinex Universe Homepage" />
  </a>
  <img src="http://alinex.github.io/images/Alinex-200.png"
    style="display:none" alt="preloading" />
</div>
<div class="links">
  <a href="http://alinex.github.io/blog"
    class="btn btn-primary"><span class="glyphicon-pencil"></span> Blog</a>
  <a href="http://alinex.github.io/develop"
    class="btn btn-primary"><span class="glyphicon-book"></span> Develop</a>
  <a href="http://alinex.github.io/code.html"
    class="btn btn-warning"><span class="glyphicon-cog"></span> Code</a>
</div>
</nav><div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#startup-script">Startup script</a>
      </div>

      <div class="heading h3">
        <a href="#main-routine">Main routine</a>
      </div>

      <div class="heading h3">
        <a href="#task-libraries">Task libraries</a>
      </div>

      <div class="heading h2">
        <a href="#node-modules">Node Modules</a>
      </div>

      <div class="heading h2">
        <a href="#configuration-of-shortcut-groups">Configuration of shortcut groups</a>
      </div>

      <div class="heading h2">
        <a href="#start-argument-parsing">Start argument parsing</a>
      </div>

      <div class="heading h2">
        <a href="#helper">Helper</a>
      </div>

      <div class="heading h2">
        <a href="#different-reports">Different reports</a>
      </div>

      <div class="heading h3">
        <a href="#list">list</a>
      </div>

      <div class="heading h3">
        <a href="#summary">summary</a>
      </div>

      <div class="heading h2">
        <a href="#start-the-processing">Start the processing</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container" tabindex="0"><a id="fork" href="https://github.com/alinex/node-worktime" title="Fork me on GitHub"></a>
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="startup-script">
  <h1>
    <a href="#startup-script" name="startup-script" class="pilcrow"></a>
Startup script
  </h1>
</div>
<p>This file is used to manage the whole build environment.</p>
<div class="pilwrap" id="main-routine">
  <h3>
    <a href="#main-routine" name="main-routine" class="pilcrow"></a>
Main routine
  </h3>
</div>
<p>This file defines the command line interface with the defined commands. They
will be run in parallel as possible.</p>
<p>It will work with an boolean <code>success</code> value which is handed through the
functions to define if everything went correct or something was not possible.
If an real and unexpected error occur it will be thrown. All errors which
aren't caught will end in an error and abort with exit code 2.</p>
<div class="pilwrap" id="task-libraries">
  <h3>
    <a href="#task-libraries" name="task-libraries" class="pilcrow"></a>
Task libraries
  </h3>
</div>
<p>Each task is made available as separate task module with the <code>run</code> method
to be called for each alinex package. The given command on the command line
call may trigger multiple tasks which are done.</p>
<p>Each task will get a <code>command</code> object which holds all the information from the
command line call.</p>

        </td>
        <td class="code highlight">
          
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="node-modules">
  <h2>
    <a href="#node-modules" name="node-modules" class="pilcrow"></a>
Node Modules
  </h2>
</div>

        </td>
        <td class="code highlight">
          
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>include base modules</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">yargs = <span class="hljs-built_in">require</span> <span class="hljs-string">'yargs'</span>
path = <span class="hljs-built_in">require</span> <span class="hljs-string">'path'</span>
chalk = <span class="hljs-built_in">require</span> <span class="hljs-string">'chalk'</span>
prompt = <span class="hljs-built_in">require</span> <span class="hljs-string">'prompt'</span>
moment = <span class="hljs-built_in">require</span> <span class="hljs-string">'moment'</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>include alinex modules</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">async = <span class="hljs-built_in">require</span> <span class="hljs-string">'alinex-async'</span>
fs = <span class="hljs-built_in">require</span> <span class="hljs-string">'alinex-fs'</span>
{string} = <span class="hljs-built_in">require</span> <span class="hljs-string">'alinex-util'</span>
errorHandler = <span class="hljs-built_in">require</span> <span class="hljs-string">'alinex-error'</span>
errorHandler.install()</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="configuration-of-shortcut-groups">
  <h2>
    <a href="#configuration-of-shortcut-groups" name="configuration-of-shortcut-groups" class="pilcrow"></a>
Configuration of shortcut groups
  </h2>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">groups =
  a: <span class="hljs-string">'allgemein'</span>
  b: <span class="hljs-string">'betrieb'</span>
  e: <span class="hljs-string">'entwicklung'</span>
  t: <span class="hljs-string">'ticket'</span>
  j: <span class="hljs-string">'jira'</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="start-argument-parsing">
  <h2>
    <a href="#start-argument-parsing" name="start-argument-parsing" class="pilcrow"></a>
Start argument parsing
  </h2>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">argv = yargs
.usage(<span class="hljs-string">"""
  Utility to log work times on different projects.

  Usage: $0 [task] [comment]
  .      $0 -r &lt;report name&gt; -d &lt;date&gt;
  """</span>)</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>examples</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">.example(<span class="hljs-string">'$0 t-1212'</span>, <span class="hljs-string">'to log the start on working on ticket 1212'</span>)
.example(<span class="hljs-string">'$0'</span>, <span class="hljs-string">'to end working on the previous task'</span>)
.example(<span class="hljs-string">'$0 -r summary -d 2015-03'</span>, <span class="hljs-string">'to get a summary report for the given date'</span>)</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>report options</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">.string(<span class="hljs-string">'r'</span>)
.alias(<span class="hljs-string">'r'</span>, <span class="hljs-string">'report'</span>)
.describe(<span class="hljs-string">'r'</span>, <span class="hljs-string">'show summary report in given format'</span>)
.alias(<span class="hljs-string">'d'</span>, <span class="hljs-string">'date'</span>)
.describe(<span class="hljs-string">'d'</span>, <span class="hljs-string">'select date for list or report using yyyy, yyyy-mm or yyyy-mm-dd'</span>)</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<p>general help</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">.help(<span class="hljs-string">'h'</span>)
.alias(<span class="hljs-string">'h'</span>, <span class="hljs-string">'help'</span>)
.showHelpOnFail(<span class="hljs-literal">false</span>, <span class="hljs-string">"Specify --help for available options"</span>)
.strict()
.argv</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="helper">
  <h2>
    <a href="#helper" name="helper" class="pilcrow"></a>
Helper
  </h2>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript"><span class="hljs-function"><span class="hljs-title">addlog</span> = <span class="hljs-params">(task, desc, cb = -&gt;)</span> -&gt;</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<p>extend task</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  <span class="hljs-keyword">if</span> task
    cat = task.split <span class="hljs-regexp">/-/</span>
    task = groups[cat[<span class="hljs-number">0</span>]] ? cat[<span class="hljs-number">0</span>]
    task += <span class="hljs-string">'-'</span> + cat[<span class="hljs-number">1.</span>.].join <span class="hljs-string">'-'</span> <span class="hljs-keyword">if</span> cat.length &gt; <span class="hljs-number">1</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<p>get logfile</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  time = moment()
  dir = path.join __dirname, <span class="hljs-string">'../var/local/data'</span>
  file = path.join dir, <span class="hljs-string">"<span class="hljs-subst">#{time.format <span class="hljs-string">'YYYY-MM'</span>}</span>.log"</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<p>output last log</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  lastlog time, dir, file, <span class="hljs-function">-&gt;</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14"></a>
</div>
<p>write new log</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">    fs.mkdirs dir, <span class="hljs-function"><span class="hljs-params">(err)</span> -&gt;</span>
      <span class="hljs-keyword">return</span> cb err <span class="hljs-keyword">if</span> err
      msg = <span class="hljs-keyword">if</span> task <span class="hljs-keyword">then</span> <span class="hljs-string">"<span class="hljs-subst">#{time.format()}</span> <span class="hljs-subst">#{task}</span> <span class="hljs-subst">#{desc}</span>\n"</span> <span class="hljs-keyword">else</span> <span class="hljs-string">"<span class="hljs-subst">#{time.format()}</span>\n"</span>
      fs.appendFile file, msg, <span class="hljs-function"><span class="hljs-params">(err)</span> -&gt;</span>
        <span class="hljs-keyword">return</span> cb err <span class="hljs-keyword">if</span> err
        <span class="hljs-keyword">if</span> task
          <span class="hljs-built_in">console</span>.log <span class="hljs-string">"Your new task was logged."</span>
        <span class="hljs-keyword">else</span>
          <span class="hljs-built_in">console</span>.log <span class="hljs-string">"Logged a stop of last task."</span>
        cb()
<span class="hljs-function">
<span class="hljs-title">lastlog</span> = <span class="hljs-params">(time, dir, file, cb)</span> -&gt;</span>
  fs.readFile file, <span class="hljs-string">'utf-8'</span>, <span class="hljs-function"><span class="hljs-params">(err, text)</span> -&gt;</span>
    <span class="hljs-keyword">return</span> cb() <span class="hljs-keyword">if</span> err
    lines = text.trim().split <span class="hljs-regexp">/\n/</span>
    values = lines[lines.length<span class="hljs-number">-1</span>].split <span class="hljs-regexp">/\ /</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15"></a>
</div>
<p>only go on if no end log</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">    <span class="hljs-keyword">return</span> cb() <span class="hljs-keyword">unless</span> values.length &gt; <span class="hljs-number">2</span>
    stime = moment values[<span class="hljs-number">0</span>]
    diff = Math.ceil time.diff stime, <span class="hljs-string">'minutes'</span>, <span class="hljs-literal">true</span>
    task = values[<span class="hljs-number">1</span>]
    desc = values[<span class="hljs-number">2.</span>.].join <span class="hljs-string">' '</span>
    <span class="hljs-built_in">console</span>.log chalk.yellow <span class="hljs-string">"You worked on <span class="hljs-subst">#{task}</span> for <span class="hljs-subst">#{diff}</span> minutes (<span class="hljs-subst">#{desc}</span>)."</span>
    cb()
<span class="hljs-function">
<span class="hljs-title">description</span> = <span class="hljs-params">(argv, cb)</span> -&gt;</span>
  <span class="hljs-keyword">if</span> argv.length &gt; <span class="hljs-number">1</span>
    <span class="hljs-keyword">return</span> cb <span class="hljs-literal">null</span>, argv[<span class="hljs-number">1.</span>.].join <span class="hljs-string">' '</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16"></a>
</div>
<p>ask for details</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  prompt.start()
  prompt.get
    properties:
      detail:
        message: <span class="hljs-string">"Give some description to log <span class="hljs-subst">#{task}</span>"</span>
        validator: <span class="hljs-regexp">/.{5,}/</span>,
  , <span class="hljs-function"><span class="hljs-params">(err, input)</span> -&gt;</span>
    <span class="hljs-keyword">return</span> cb err, input?.detail
<span class="hljs-function">
<span class="hljs-title">readlog</span> = <span class="hljs-params">(date, cb)</span> -&gt;</span>
  date ?= moment().format <span class="hljs-string">'YYYY-MM-DD'</span>
  dir = path.join __dirname, <span class="hljs-string">'../var/local/data'</span>
  log = []</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17"></a>
</div>
<p>read all logs</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  <span class="hljs-keyword">if</span> date.length <span class="hljs-keyword">is</span> <span class="hljs-number">10</span>
    file = path.join dir,  <span class="hljs-string">"<span class="hljs-subst">#{date[<span class="hljs-number">0.</span><span class="hljs-number">.6</span>]}</span>.log"</span>
    fs.readFile file, <span class="hljs-string">'utf-8'</span>, <span class="hljs-function"><span class="hljs-params">(err, text)</span> -&gt;</span>
      <span class="hljs-keyword">return</span> cb err <span class="hljs-keyword">if</span> err
      <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> text.trim().split <span class="hljs-regexp">/\n/</span>
        values = line.split <span class="hljs-regexp">/\ /</span>
        <span class="hljs-keyword">if</span> string.starts values[<span class="hljs-number">0</span>], date
          names = values[<span class="hljs-number">1</span>]?.split <span class="hljs-regexp">/-/</span>
          log.push
            time: values[<span class="hljs-number">0</span>]
            name: values[<span class="hljs-number">1</span>]
            group: [names?[<span class="hljs-number">0</span>], names?[<span class="hljs-number">1.</span>.].join <span class="hljs-string">'-'</span>]
            desc: values[<span class="hljs-number">2.</span>.]?.join <span class="hljs-string">' '</span>
      cb <span class="hljs-literal">null</span>, log
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> date.length <span class="hljs-keyword">is</span> <span class="hljs-number">7</span>
    file = path.join dir,  <span class="hljs-string">"<span class="hljs-subst">#{date}</span>.log"</span>
    fs.readFile file, <span class="hljs-string">'utf-8'</span>, <span class="hljs-function"><span class="hljs-params">(err, text)</span> -&gt;</span>
      <span class="hljs-keyword">return</span> cb err <span class="hljs-keyword">if</span> err
      <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> text.trim().split <span class="hljs-regexp">/\n/</span>
        values = line.split <span class="hljs-regexp">/\ /</span>
        names = values[<span class="hljs-number">1</span>]?.split <span class="hljs-regexp">/-/</span>
        log.push
          time: values[<span class="hljs-number">0</span>]
          name: values[<span class="hljs-number">1</span>]
          group: [names?[<span class="hljs-number">0</span>], names?[<span class="hljs-number">1.</span>.].join <span class="hljs-string">'-'</span>]
          desc: values[<span class="hljs-number">2.</span>.]?.join <span class="hljs-string">' '</span>
      cb <span class="hljs-literal">null</span>, log
  <span class="hljs-keyword">else</span>
    async.each [<span class="hljs-number">1.</span><span class="hljs-number">.12</span>], <span class="hljs-function"><span class="hljs-params">(month, cb)</span> -&gt;</span>
      file = path.join dir,  <span class="hljs-string">"<span class="hljs-subst">#{date}</span>-<span class="hljs-subst">#{string.lpad month, <span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>}</span>.log"</span>
      fs.readFile file, <span class="hljs-string">'utf-8'</span>, <span class="hljs-function"><span class="hljs-params">(err, text)</span> -&gt;</span>
        <span class="hljs-keyword">unless</span> err
          <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> text.trim().split <span class="hljs-regexp">/\n/</span>
            values = line.split <span class="hljs-regexp">/\ /</span>
            names = values[<span class="hljs-number">1</span>]?.split <span class="hljs-regexp">/-/</span>
            log.push
              time: values[<span class="hljs-number">0</span>]
              name: values[<span class="hljs-number">1</span>]
              group: [names?[<span class="hljs-number">0</span>], names?[<span class="hljs-number">1.</span>.].join <span class="hljs-string">'-'</span>]
              desc: values[<span class="hljs-number">2.</span>.]?.join <span class="hljs-string">' '</span>
        cb()
    , <span class="hljs-function"><span class="hljs-params">(err)</span> -&gt;</span> cb err, log
<span class="hljs-function">
<span class="hljs-title">group</span> = <span class="hljs-params">(logs)</span> -&gt;</span>
  data = {}
  <span class="hljs-keyword">for</span> log <span class="hljs-keyword">in</span> logs</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18"></a>
</div>
<p>calculate previous line</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">    <span class="hljs-keyword">if</span> last
      diff = Math.ceil moment(log.time).diff last.time, <span class="hljs-string">'minutes'</span>, <span class="hljs-literal">true</span>
      day = last.time[<span class="hljs-number">0.</span><span class="hljs-number">.9</span>]
      data[day] ?= {}
      data[day][last.group[<span class="hljs-number">0</span>]] ?= {}
      data[day][last.group[<span class="hljs-number">0</span>]][last.group[<span class="hljs-number">1</span>] ? <span class="hljs-string">'-'</span>] ?=
        time: <span class="hljs-number">0</span>
        comment: []
      entry = data[day][last.group[<span class="hljs-number">0</span>]][last.group[<span class="hljs-number">1</span>]]
      entry.time += diff
      entry.comment.push last.desc <span class="hljs-keyword">unless</span> last.desc <span class="hljs-keyword">in</span> entry.comment</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19"></a>
</div>
<p>keep for next line</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">    last = <span class="hljs-keyword">if</span> log.name? <span class="hljs-keyword">then</span> log <span class="hljs-keyword">else</span> <span class="hljs-literal">null</span>
  data</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="different-reports">
  <h2>
    <a href="#different-reports" name="different-reports" class="pilcrow"></a>
Different reports
  </h2>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">report =</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="list">
  <h3>
    <a href="#list" name="list" class="pilcrow"></a>
list
  </h3>
</div>
<p>Chronological list of tasks which were done</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  list: <span class="hljs-function"><span class="hljs-params">(logs, cb)</span> -&gt;</span>
    <span class="hljs-built_in">console</span>.log <span class="hljs-string">'DATE\tSTART\tEND\tMINUTES\tGROUP\tTASK\tCOMMENT'</span>
    last = <span class="hljs-literal">null</span>
    <span class="hljs-keyword">for</span> log <span class="hljs-keyword">in</span> logs</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-22" id="section-22"></a>
</div>
<p>calculate previous line</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">      <span class="hljs-keyword">if</span> last
        diff = Math.ceil moment(log.time).diff last.time, <span class="hljs-string">'minutes'</span>, <span class="hljs-literal">true</span>
        <span class="hljs-built_in">console</span>.log <span class="hljs-string">"<span class="hljs-subst">#{last.time[<span class="hljs-number">0.</span><span class="hljs-number">.9</span>]}</span>\t<span class="hljs-subst">#{last.time[<span class="hljs-number">11.</span><span class="hljs-number">.15</span>]}</span>\t<span class="hljs-subst">#{log.time[<span class="hljs-number">11.</span><span class="hljs-number">.15</span>]}</span>\t\
</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-23" id="section-23"></a>
</div>
<p>{diff}\t#{last.group[0]}\t#{last.group[1]}\t#{last.desc}&quot;
keep for next line</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">      last = <span class="hljs-keyword">if</span> log.name? <span class="hljs-keyword">then</span> log <span class="hljs-keyword">else</span> <span class="hljs-literal">null</span>
    cb()</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="summary">
  <h3>
    <a href="#summary" name="summary" class="pilcrow"></a>
summary
  </h3>
</div>
<p>calculation of each task per day</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  summary: <span class="hljs-function"><span class="hljs-params">(logs, cb)</span> -&gt;</span>
    <span class="hljs-built_in">console</span>.log <span class="hljs-string">"DAY\tMINUTES\tGROUP\tTASK"</span>
    <span class="hljs-keyword">for</span> day,data <span class="hljs-keyword">of</span> group logs
      <span class="hljs-keyword">for</span> category <span class="hljs-keyword">of</span> data
        <span class="hljs-keyword">for</span> task,entry <span class="hljs-keyword">of</span> data[category]
          <span class="hljs-built_in">console</span>.log <span class="hljs-string">"<span class="hljs-subst">#{day}</span>\t<span class="hljs-subst">#{entry.time}</span>\t<span class="hljs-subst">#{category}</span>\t<span class="hljs-subst">#{task}</span>"</span>
    cb()</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="start-the-processing">
  <h2>
    <a href="#start-the-processing" name="start-the-processing" class="pilcrow"></a>
Start the processing
  </h2>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript"><span class="hljs-keyword">if</span> argv.report?
  readlog argv.date, <span class="hljs-function"><span class="hljs-params">(err, logs)</span> -&gt;</span>
    <span class="hljs-keyword">throw</span> err <span class="hljs-keyword">if</span> err
    <span class="hljs-keyword">unless</span> report[argv.report]?
      <span class="hljs-built_in">console</span>.error chalk.red <span class="hljs-string">"Please specify a valid report format: <span class="hljs-subst">#{Object.keys(report).join <span class="hljs-string">', '</span>}</span>"</span>
    report[argv.report] logs, <span class="hljs-function"><span class="hljs-params">(err)</span> -&gt;</span>
      <span class="hljs-keyword">throw</span> err <span class="hljs-keyword">if</span> err
<span class="hljs-keyword">else</span> <span class="hljs-keyword">unless</span> argv._?[<span class="hljs-number">0</span>]
  addlog()
<span class="hljs-keyword">else</span>
  task = argv._[<span class="hljs-number">0</span>]
  description argv._, <span class="hljs-function"><span class="hljs-params">(err, desc)</span> -&gt;</span>
    <span class="hljs-keyword">throw</span> err <span class="hljs-keyword">if</span> err
    addlog task, desc, <span class="hljs-function"><span class="hljs-params">(err)</span> -&gt;</span>
      <span class="hljs-keyword">throw</span> err <span class="hljs-keyword">if</span> err</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
